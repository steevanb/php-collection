#!/usr/bin/env bash

set -eu

readonly ROOT_DIR="$(realpath "$(dirname "$(realpath "$0")")/../..")"
. "${ROOT_DIR}"/bin/common.inc.sh

docker \
    build \
        --tag "${CI_DOCKER_IMAGE_NAME}" \
        --file "${ROOT_DIR}"/docker/Dockerfile \
        "${ROOT_DIR}"

push=false
for param in "${@}"; do
    if [ "${param}" == "--push" ]; then
        push=true
    fi
done

if [ "${push}" == true ]; then
    docker push "${CI_DOCKER_IMAGE_NAME}"
fi
