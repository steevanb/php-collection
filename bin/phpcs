#!/usr/bin/env sh

readonly PROJECT_DIRECTORY=$(realpath $(dirname $(realpath $0))/..)

set -e

if [ $(which docker || false) ]; then
    docker run \
        --rm \
        -e PHPCS_PARAMETERS="--warning-severity=0 --ignore=/vendor/" \
        -e PHPCS_BOOTSTRAP=/var/phpcs-bootstrap.php \
        -v $(pwd)/$(dirname $0)/../phpcs.bootstrap.php:/var/phpcs-bootstrap.php:ro \
        -v $(pwd)/$(dirname $0)/..:/var/phpcs:ro \
        steevanb/php-code-sniffs:2.0.10 \
        ${PROJECT_DIRECTORY}/bin/phpcs
else
    /var/entrypoint.sh
fi
