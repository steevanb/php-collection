#!/usr/bin/env sh

set -eu

readonly ROOT_DIR="$(realpath "$(dirname "$(realpath "$0")")/..")"
. "${ROOT_DIR}"/bin/common.inc.sh
BIN_DIR=bin COMPOSER_HOME=/app/var/composer . "${ROOT_DIR}"/bin/dockerise.inc.bash

removeComposerLock() {
    if [ -f "${ROOT_DIR}"/composer.lock ]; then
        rm "${ROOT_DIR}"/composer.lock
    fi
}

removeComposerLock
php8.1 /usr/local/bin/composer "${@}"
removeComposerLock
